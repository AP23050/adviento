<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendario de Adviento ðŸŽ„</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:linear-gradient(135deg,#f6c1d1,#e7c6ff,#c1e1dc,#fff4c1);
  color:#5b3c3c;
}
.app{
  max-width:720px;
  margin:auto;
  padding:20px;
  text-align:center;
}
h1{color:#c2185b}

/* CALENDAR */
#calendar{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:10px;
}
.day{
  background:#fff;
  border-radius:16px;
  padding:18px 0;
  font-weight:700;
  cursor:pointer;
}
.day.opened{
  background:#ffe3ea;
}

/* MODAL */
#modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  align-items:center;
  justify-content:center;
}
.modalBox{
  background:#fff;
  padding:25px;
  border-radius:20px;
  width:90%;
  max-width:380px;
}
button{
  margin-top:10px;
  padding:12px 22px;
  border:none;
  border-radius:14px;
  background:#ff7a8a;
  color:#fff;
  font-size:1rem;
}
#preview{
  max-width:100%;
  border-radius:12px;
  margin-top:10px;
}

/* GALLERY */
#gallery{
  margin-top:35px;
}
.galleryItem{
  background:#fff;
  border-radius:18px;
  padding:15px;
  margin-bottom:20px;
}
.galleryItem strong{
  display:block;
  margin-bottom:8px;
  color:#c2185b;
}
.galleryItem img{
  max-width:100%;
  border-radius:14px;
}

/* PDF */
#pdfBtn{
  margin-top:30px;
  background:#6a1b9a;
}

footer{
  margin:30px 0;
  font-size:1.3rem;
  color:#c2185b;
}

@media(max-width:600px){
  #calendar{grid-template-columns:repeat(4,1fr)}
}
</style>
</head>

<body>
<div class="app">

<h1>Calendario de Adviento ðŸŽ„</h1>

<div id="calendar"></div>

<!-- MODAL -->
<div id="modal">
  <div class="modalBox">
    <h2 id="giftText"></h2>
    <input type="file" id="photoInput" accept="image/*">
    <img id="preview">
    <button onclick="saveLocal()">ðŸ’¾ Guardar recuerdo</button>
    <button onclick="closeModal()">Cerrar</button>
  </div>
</div>

<!-- GALLERY -->
<section id="gallery">
  <h2>Recuerdos guardados ðŸ“¸</h2>
  <div id="galleryList"></div>
</section>

<button id="pdfBtn" onclick="generatePDF()">ðŸ“„ Generar PDF final</button>

<footer>Te ama mucho Rodri ðŸ’™</footer>
</div>

<script>
const gifts=[
"Sandalias","$10 dÃ³lares","UÃ±as manos","UÃ±as pies","Gancho","Salutaris",
"Calcetines","Takis fuego","Toallas hÃºmedas","Pringles queso","Starbucks","Ramo de flores",
"Tosty / barra Bon Bon","Almendras","Limas","Chamoy","Gomitas","Vela aromÃ¡tica",
"AlgodÃ³n","Taza","Perfume Givenchy","Lipstick Revlon","Labial Givenchy","LociÃ³n CK Euphoria"
];

let memories={};
let currentDay=null;

const calendar=document.getElementById("calendar");
const modal=document.getElementById("modal");
const giftText=document.getElementById("giftText");
const photoInput=document.getElementById("photoInput");
const preview=document.getElementById("preview");
const galleryList=document.getElementById("galleryList");

/* CREATE CALENDAR */
for(let i=1;i<=24;i++){
  const d=document.createElement("div");
  d.className="day";
  d.textContent=i;
  d.onclick=()=>openDay(i);
  calendar.appendChild(d);
}

function openDay(day){
  if(day===24){
    const now=new Date();
    if(now.getMonth()!==11 || now.getDate()!==24){
      alert("El dÃ­a 24 solo se abre el 24 de diciembre ðŸŽ„");
      return;
    }
  }
  currentDay=day;
  giftText.textContent=`ðŸŽ DÃ­a ${day} â€“ ${gifts[day-1]}`;
  photoInput.value="";
  preview.src="";
  modal.style.display="flex";
}

photoInput.onchange=()=>{
  if(photoInput.files[0]){
    preview.src=URL.createObjectURL(photoInput.files[0]);
  }
};

function saveLocal(){
  if(!photoInput.files[0]) return alert("Selecciona una foto");
  const reader=new FileReader();
  reader.onload=()=>{
    memories[currentDay]=reader.result;
    document.querySelectorAll(".day")[currentDay-1].classList.add("opened");
    renderGallery();
    closeModal();
  };
  reader.readAsDataURL(photoInput.files[0]);
}

function renderGallery(){
  galleryList.innerHTML="";
  Object.keys(memories).sort((a,b)=>a-b).forEach(d=>{
    const div=document.createElement("div");
    div.className="galleryItem";
    div.innerHTML=`
      <strong>DÃ­a ${d} â€“ ${gifts[d-1]}</strong>
      <img src="${memories[d]}">
    `;
    galleryList.appendChild(div);
  });
}

function closeModal(){
  modal.style.display="none";
}

/* PDF */
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const pdf=new jsPDF();
  let y=10;

  pdf.setFontSize(18);
  pdf.text("Calendario de Adviento ðŸŽ„",10,y);
  y+=12;

  Object.keys(memories).sort((a,b)=>a-b).forEach(d=>{
    pdf.setFontSize(12);
    pdf.text(`DÃ­a ${d} â€“ ${gifts[d-1]}`,10,y);
    y+=6;
    pdf.addImage(memories[d],"JPEG",10,y,180,100);
    y+=110;
    if(y>260){
      pdf.addPage();
      y=10;
    }
  });

  pdf.save("Calendario_Adviento.pdf");
}
</script>
</body>
</html>