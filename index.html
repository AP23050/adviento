<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calendario de Adviento</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#ffd1e8,#d6f0ff);
  text-align:center;
}

h1{ color:#c2185b; }

#portada{
  padding:30px;
}

#progreso{
  background:white;
  margin:20px;
  padding:20px;
  border-radius:20px;
}

#corazones span{
  font-size:24px;
}

#calendario{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:10px;
  padding:20px;
}

.dia{
  background:white;
  padding:15px;
  border-radius:15px;
  cursor:pointer;
  font-weight:bold;
}

.dia.guardado{
  background:#ffb6c1;
}

#modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}

#modalContenido{
  background:white;
  padding:20px;
  border-radius:15px;
  width:90%;
  max-width:300px;
}

#galeria{
  padding:20px;
}

#gridGaleria{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}

.card img{
  width:100%;
  border-radius:10px;
}

button{
  padding:10px 15px;
  border:none;
  border-radius:10px;
  background:#ff5c8a;
  color:white;
  font-weight:bold;
}
</style>
</head>

<body>

<section id="portada">
  <h1>üéÑ Calendario de Adviento</h1>
  <p>Un recuerdo por cada d√≠a</p>
</section>

<section id="progreso">
  <div id="corazones"></div>
  <p id="textoProgreso">Progreso: 0%</p>
</section>

<section id="calendario"></section>

<section id="galeria">
  <h2>üì∏ Galer√≠a de recuerdos</h2>
  <div id="gridGaleria"></div>
</section>

<button onclick="generarPDF()">üìÑ Generar PDF</button>

<div id="modal">
  <div id="modalContenido">
    <h3 id="tituloDia"></h3>
    <input type="file" id="inputFoto" accept="image/*"><br><br>
    <input type="text" id="inputTexto" placeholder="Descripci√≥n"><br><br>
    <button onclick="guardar()">Guardar</button>
    <button onclick="cerrar()">Cerrar</button>
  </div>
</div>

<script>
const TOTAL=24;
let diaActual=null;

function iniciar(){
  for(let i=1;i<=TOTAL;i++){
    const d=document.createElement("div");
    d.className="dia";
    d.textContent=i;
    d.onclick=()=>abrir(i);
    d.id="dia"+i;
    document.getElementById("calendario").appendChild(d);
  }
  cargar();
}

function abrir(dia){
  diaActual=dia;
  document.getElementById("tituloDia").textContent="D√≠a "+dia;
  document.getElementById("modal").style.display="flex";
}

function cerrar(){
  document.getElementById("modal").style.display="none";
}

function guardar(){
  const file=document.getElementById("inputFoto").files[0];
  const texto=document.getElementById("inputTexto").value;
  if(!file)return alert("Selecciona una foto");

  const reader=new FileReader();
  reader.onload=e=>{
    localStorage.setItem("dia"+diaActual,JSON.stringify({
      img:e.target.result,
      texto:texto
    }));
    cerrar();
    cargar();
  };
  reader.readAsDataURL(file);
}

function cargar(){
  const gal=document.getElementById("gridGaleria");
  gal.innerHTML="";
  let cont=0;

  for(let i=1;i<=TOTAL;i++){
    const data=localStorage.getItem("dia"+i);
    const btn=document.getElementById("dia"+i);
    if(data){
      btn.classList.add("guardado");
      cont++;
      const obj=JSON.parse(data);
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`<img src="${obj.img}"><p>D√≠a ${i}<br>${obj.texto||""}</p>`;
      gal.appendChild(c);
    }
  }

  document.getElementById("textoProgreso").textContent=
    `Progreso: ${Math.round((cont/TOTAL)*100)}%`;

  document.getElementById("corazones").innerHTML=
    "‚ù§Ô∏è".repeat(cont)+"ü§ç".repeat(TOTAL-cont);
}

function generarPDF(){
  html2pdf().from(document.getElementById("galeria")).save("Calendario.pdf");
}

iniciar();
</script>

</body>
</html>