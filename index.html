<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendario de Adviento üéÑ</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --pink:#f6c1d1;
  --lav:#e7c6ff;
  --mint:#c1e1dc;
  --beige:#fff4c1;
  --accent:#ff7a8a;
  --text:#5b3c3c;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:linear-gradient(135deg,var(--pink),var(--lav),var(--mint),var(--beige));
  color:var(--text);
}

.app{
  max-width:720px;
  margin:auto;
  padding:20px;
  text-align:center;
}

h1{color:#c2185b}

/* üéÑ ARBOLITO */
#tree{
  font-size:64px;
  position:relative;
  margin:10px auto 20px;
  width:80px;
}
.light{
  position:absolute;
  width:8px;
  height:8px;
  border-radius:50%;
  animation:blink 1.2s infinite alternate;
}
.red{background:#ff5252; top:20px; left:30px}
.yellow{background:#ffd740; top:35px; left:45px; animation-delay:.3s}
.blue{background:#40c4ff; top:45px; left:25px; animation-delay:.6s}
.green{background:#69f0ae; top:30px; left:15px; animation-delay:.9s}

@keyframes blink{
  0%{opacity:.2}
  100%{opacity:1}
}

/* ‚ù§Ô∏è PROGRESO */
#progressBox{
  background:#fff;
  padding:16px;
  border-radius:20px;
  margin:20px 0;
}
#progressTrack{
  width:100%;
  height:22px;
  background:#fde2ea;
  border-radius:14px;
  overflow:hidden;
}
#progressFill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#ff9aa2,#ffb7b2);
  border-radius:14px;
  display:flex;
  align-items:center;
  transition:width .4s ease;
}
.hearts{
  font-size:14px;
  white-space:nowrap;
  padding-left:8px;
  animation:floatHearts 2s linear infinite;
}
@keyframes floatHearts{
  0%{transform:translateX(0)}
  100%{transform:translateX(10px)}
}
#progressText{
  margin-top:8px;
  font-weight:600;
  color:#c2185b;
}

/* üìÖ CALENDARIO */
#calendar{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:10px;
}
.day{
  background:#fff;
  border-radius:16px;
  padding:18px 0;
  font-weight:700;
  cursor:pointer;
}
.day.opened{background:#ffe3ea}

/* MODAL */
#modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  align-items:center;
  justify-content:center;
}
.modalBox{
  background:#fff;
  padding:25px;
  border-radius:20px;
  width:90%;
  max-width:380px;
}
button{
  margin-top:10px;
  padding:12px 22px;
  border:none;
  border-radius:14px;
  background:var(--accent);
  color:#fff;
  font-size:1rem;
}
#preview{
  max-width:100%;
  border-radius:12px;
  margin-top:10px;
}

/* GALER√çA */
#gallery{
  margin-top:35px;
}
.galleryItem{
  background:#fff;
  border-radius:18px;
  padding:15px;
  margin-bottom:20px;
}
.galleryItem strong{
  display:block;
  margin-bottom:8px;
  color:#c2185b;
}
.galleryItem img{
  max-width:100%;
  border-radius:14px;
}

/* PDF */
#pdfBtn{
  margin-top:30px;
  background:#6a1b9a;
}

footer{
  margin:30px 0;
  font-size:1.3rem;
  color:#c2185b;
}

@media(max-width:600px){
  #calendar{grid-template-columns:repeat(4,1fr)}
}
</style>
</head>

<body>
<div class="app">

<h1>Calendario de Adviento üéÑ</h1>

<div id="tree">
  üéÑ
  <span class="light red"></span>
  <span class="light yellow"></span>
  <span class="light blue"></span>
  <span class="light green"></span>
</div>

<!-- PROGRESO -->
<div id="progressBox">
  <div id="progressTrack">
    <div id="progressFill">
      <span class="hearts">‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è</span>
    </div>
  </div>
  <p id="progressText">Progreso: 0% (0/24)</p>
</div>

<!-- CALENDARIO -->
<div id="calendar"></div>

<!-- MODAL -->
<div id="modal">
  <div class="modalBox">
    <h2 id="giftText"></h2>
    <input type="file" id="photoInput" accept="image/*">
    <img id="preview">
    <button onclick="saveLocal()">üíæ Guardar recuerdo</button>
    <button onclick="closeModal()">Cerrar</button>
  </div>
</div>

<!-- GALER√çA -->
<section id="gallery">
  <h2>Recuerdos guardados üì∏</h2>
  <div id="galleryList"></div>
</section>

<button id="pdfBtn" onclick="generatePDF()">üìÑ Generar PDF final</button>

<footer>Te ama mucho Rodri üíô</footer>
</div>

<script>
const gifts=[
"Sandalias","$10 d√≥lares","U√±as manos","U√±as pies","Gancho","Salutaris",
"Calcetines","Takis fuego","Toallas h√∫medas","Pringles queso","Starbucks","Ramo de flores",
"Tosty / barra Bon Bon","Almendras","Limas","Chamoy","Gomitas","Vela arom√°tica",
"Algod√≥n","Taza","Perfume Givenchy","Lipstick Revlon","Labial Givenchy","Loci√≥n CK Euphoria"
];

let memories={};
let currentDay=null;

const calendar=document.getElementById("calendar");
const modal=document.getElementById("modal");
const giftText=document.getElementById("giftText");
const photoInput=document.getElementById("photoInput");
const preview=document.getElementById("preview");
const galleryList=document.getElementById("galleryList");

/* Crear calendario */
for(let i=1;i<=24;i++){
  const d=document.createElement("div");
  d.className="day";
  d.textContent=i;
  d.onclick=()=>openDay(i);
  calendar.appendChild(d);
}

function openDay(day){
  if(day===24){
    const now=new Date();
    if(now.getMonth()!==11 || now.getDate()!==24){
      alert("El d√≠a 24 solo se abre el 24 de diciembre üéÑ");
      return;
    }
  }
  currentDay=day;
  giftText.textContent=`üéÅ D√≠a ${day} ‚Äì ${gifts[day-1]}`;
  photoInput.value="";
  preview.src="";
  modal.style.display="flex";
}

photoInput.onchange=()=>{
  if(photoInput.files[0]){
    preview.src=URL.createObjectURL(photoInput.files[0]);
  }
};

function saveLocal(){
  if(!photoInput.files[0]) return alert("Selecciona una foto");
  const reader=new FileReader();
  reader.onload=()=>{
    memories[currentDay]=reader.result;
    document.querySelectorAll(".day")[currentDay-1].classList.add("opened");
    renderGallery();
    updateProgress();
    closeModal();
  };
  reader.readAsDataURL(photoInput.files[0]);
}

function renderGallery(){
  galleryList.innerHTML="";
  Object.keys(memories).sort((a,b)=>a-b).forEach(d=>{
    const div=document.createElement("div");
    div.className="galleryItem";
    div.innerHTML=`
      <strong>D√≠a ${d} ‚Äì ${gifts[d-1]}</strong>
      <img src="${memories[d]}">
    `;
    galleryList.appendChild(div);
  });
}

function updateProgress(){
  const done=Object.keys(memories).length;
  const percent=Math.round((done/24)*100);
  document.getElementById("progressFill").style.width=percent+"%";
  document.getElementById("progressText").textContent=
    `Progreso: ${percent}% (${done}/24)`;
}

function closeModal(){
  modal.style.display="none";
}

/* PDF */
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const pdf=new jsPDF();
  let y=10;

  pdf.setFontSize(18);
  pdf.text("Calendario de Adviento üéÑ",10,y);
  y+=12;

  Object.keys(memories).sort((a,b)=>a-b).forEach(d=>{
    pdf.setFontSize(12);
    pdf.text(`D√≠a ${d} ‚Äì ${gifts[d-1]}`,10,y);
    y+=6;
    pdf.addImage(memories[d],"JPEG",10,y,180,100);
    y+=110;
    if(y>260){
      pdf.addPage();
      y=10;
    }
  });

  pdf.save("Calendario_Adviento.pdf");
}

updateProgress();
</script>
</body>
</html>