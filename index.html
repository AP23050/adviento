<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendario de Adviento para Macy ğŸ„</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:linear-gradient(135deg,#ffd6e8,#e6ddff);
  text-align:center;
}
h1{color:#c2185b;margin:20px}
button{
  padding:12px 22px;
  border:none;
  border-radius:20px;
  background:#c2185b;
  color:white;
  font-size:15px;
  cursor:pointer;
  margin:8px;
}
.counter{
  font-weight:bold;
  margin-bottom:10px;
  color:#444;
}

.calendar{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:15px;
  padding:20px;
  max-width:520px;
  margin:auto;
}
.day{
  background:white;
  padding:18px;
  border-radius:15px;
  font-size:18px;
  cursor:pointer;
}
.day.opened{background:#ffb3d9}

.gallery{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  padding:20px;
  max-width:1000px;
  margin:auto;
}
.gallery-item{
  background:white;
  padding:12px;
  border-radius:15px;
}
.gallery-item iframe{
  width:100%;
  height:180px;
  border-radius:12px;
}

.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  justify-content:center;
  align-items:center;
  z-index:999;
}
.modal-content{
  background:white;
  padding:20px;
  border-radius:15px;
  width:350px;
}
.modal-content iframe{
  width:100%;
  height:220px;
  border-radius:12px;
}
</style>
</head>

<body>

<h1>ğŸ Calendario de Adviento para Macy</h1>

<div class="counter" id="counter"></div>

<button onclick="goGallery()">ğŸ“¸ ColecciÃ³n</button>
<button onclick="generatePDF()">ğŸ“„ Descargar PDF</button>

<div class="calendar" id="calendar"></div>

<h2 id="galleryTitle" style="display:none">ğŸ“¸ ColecciÃ³n</h2>
<div class="gallery" id="gallery" style="display:none"></div>
<button id="backBtn" style="display:none" onclick="goCalendar()">â¬… Volver</button>

<div class="modal" id="modal">
  <div class="modal-content">
    <h3 id="modalTitle"></h3>
    <iframe id="modalFrame" style="display:none" allowfullscreen></iframe>
    <br>
    <button onclick="closeModal()">Cerrar</button>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const CLAVE_24 = "MR101025";

/* ===== REGALOS ===== */
const gifts = [
 {d:1,t:"Sandalias",id:"10MQ_9LTLm0rm4gsv7bB0aW871Z3qXYNW"},
 {d:2,t:"$10.00",id:"1IEJqpf3QRRk1hZk7mGQnsbJ-AV1Ff10M"},
 {d:3,t:"UÃ±as manos",id:"1dQc7cgO8v5YT03KfFpc-7IXdA4t-6eGI"},
 {d:4,t:"UÃ±as pies",id:"1JRqw_G6R73lZSOeoDKoJExAvLUTuKEvI"},
 {d:5,t:"Salutaris",id:"13lS5c4rYYx8opam67AfF3B3mN_V01sYz"},
 {d:6,t:"Calcetines",id:"11B4FCI6k7JXlcHPQlQhX7YdGIQb0aKEJ"},
 {d:7,t:"Takis fuego",id:"1RZylG-aJcs1dev_ME4MBHFlQkjvmo_5a"},
 {d:8,t:"Toallas hÃºmedas",id:"1SwkC_PHpLnQUZ_YxrTo5-t0a8VNxnCkG"},
 {d:9,t:"Pringles queso",id:"1qawWRiIgcsQO9v4ecEnjGjPzlCexyJjD"},
 {d:10,t:"Starbucks",id:"1VcftNU8xG3h9wC-_3ydVcXVRN2EzQUw1"},
 {d:11,t:"Tosh y bombÃ³n",id:"1gQwLQVnQ6YUgSqDPzxzGEIsrS_Lzun20"},
 {d:12,t:"Ramo de flores",id:"1OmN43-1H4D6H5Y0HEca_Re0-HfGusexY"},
 {d:13,t:"Almendras",id:"1wn80nu5RTlgHiA38wNk68kS6t-cpVR1W"},
 {d:14,t:"Limas",id:"1zFwAfgn6x5zKguGgSv7g6c2YdKjbnvQO"},
 {d:15,t:"Chamoy",id:"1NuQFMQCZN323BErAQmDpizIObqjBHYgv"},
 {d:16,t:"Gomitas",id:"1Uk8otAJ5845rVPMsc7C13grP2AttmgJx"},
 {d:17,t:"Vela aromÃ¡tica",id:"16y4jM7Jg4s5-qd7DsJexNCXHRDdv5587"},
 {d:18,t:"Taza Friends",id:"16IrQT1V9MGhFdy2eFjyBu6xkXeOBjA0w"},
 {d:19,t:"Perfume Givenchy",id:"1bN0igDoriiA_wXpXw8nPiQgPGsJEVrMv"},
 {d:20,t:"Revlon",id:"17xOoA_M1Vw2YXtKCJIzO9_MBl7bH1tk7"},
 {d:21,t:"Gancho",id:"1UrCTKjVoP346ZpePevL1Vr0qhPAODSCj"},
 {d:22,t:"Labial Givenchy",id:"19Righe5of8ZBTiZ1zvGolp-PWqDS6Pgf"},
 {d:23,t:"Desmaquillador",id:"141E5Bc0SPFgbD7nlXF7LYKcXpPcxaCH7"},
 {d:24,t:"Regalo de sorpresa ğŸ",id:"1trTCz5Z_hOJMZ3IgwAOGmvzig16-bsdx"}
];

let opened = JSON.parse(localStorage.getItem("openedDays")||"[]");

const calendar=document.getElementById("calendar");
const gallery=document.getElementById("gallery");
const counter=document.getElementById("counter");

/* ===== RENDER ===== */
function render(){
  calendar.innerHTML="";
  gallery.innerHTML="";
  counter.textContent=`DÃ­as abiertos: ${opened.length} / 24`;

  gifts.forEach(g=>{
    const div=document.createElement("div");
    div.className="day";
    div.textContent=g.d;
    if(opened.includes(g.d)) div.classList.add("opened");
    div.onclick=()=>openDay(g);
    calendar.appendChild(div);

    if(opened.includes(g.d)){
      gallery.innerHTML+=`
        <div class="gallery-item">
          <iframe 
            src="https://drive.google.com/file/d/${g.id}/preview"
            allowfullscreen>
          </iframe>
          <p>DÃ­a ${g.d} â€“ ${g.t}</p>
        </div>`;
    }
  });
}

/* ===== OPEN DAY ===== */
function openDay(g){
  if(g.d===24){
    const pass=prompt("ğŸ” Ingresa la clave especial");
    if(pass!==CLAVE_24) return alert("âŒ Clave incorrecta");
  }

  if(!opened.includes(g.d)){
    opened.push(g.d);
    localStorage.setItem("openedDays",JSON.stringify(opened));
  }

  const frame=document.getElementById("modalFrame");
  frame.src=`https://drive.google.com/file/d/${g.id}/preview`;
  frame.style.display="block";

  document.getElementById("modalTitle").textContent=`DÃ­a ${g.d} â€“ ${g.t}`;
  document.getElementById("modal").style.display="flex";
  render();
}

function closeModal(){
  document.getElementById("modal").style.display="none";
}

/* ===== VIEWS ===== */
function goGallery(){
  calendar.style.display="none";
  gallery.style.display="grid";
  document.getElementById("galleryTitle").style.display="block";
  document.getElementById("backBtn").style.display="inline-block";
}
function goCalendar(){
  calendar.style.display="grid";
  gallery.style.display="none";
  document.getElementById("galleryTitle").style.display="none";
  document.getElementById("backBtn").style.display="none";
}

/* ===== PDF ===== */
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF("p","mm","a4");

  pdf.setFillColor(255,230,240);
  pdf.rect(0,0,210,297,"F");

  pdf.setFontSize(24);
  pdf.text("ğŸ„ Calendario de Adviento ğŸ„",105,40,null,null,"center");
  pdf.setFontSize(16);
  pdf.text("Para Macy, con amor ğŸ’–",105,55,null,null,"center");

  pdf.addPage();

  let x=15,y=20,c=0;
  gifts.forEach(g=>{
    if(opened.includes(g.d)){
      const img=`https://drive.google.com/uc?export=view&id=${g.id}`;
      pdf.addImage(img,"JPEG",x,y,55,55);
      pdf.text(`DÃ­a ${g.d}`,x,y+60);
      pdf.text(g.t,x,y+67,{maxWidth:55});
      x+=60;c++;
      if(c%3===0){x=15;y+=75;}
      if(y>240){pdf.addPage();x=15;y=20;}
    }
  });

  pdf.save("Calendario_Adviento_Macy.pdf");
}

render();
</script>

</body>
</html>